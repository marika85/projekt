///////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////
//
// Perseus Spolka z o.o 
// Wszystkie prawa zastrzezone
// 
// Data utworzenia: 2001.09.01
// interfejs optibelt
// Historia zmian
//dta 2011.05.19 - zaokrgalenia dla paragonow : dla paragonow liczy netto od brutto i ewentualnie dodoaje zaokraglenia;
//dla pozostalych dokumentow liczy brutto i vat od wartosci netto
// Data:2002.07.02
//   Zmieniono .....
// 2002.09.09
//////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////
// ===== - konwersja danych
// po zmianie linii  "V" ze stawkami vat
// ostatnia wersja 2002.09.15
// ---  czy wczytywac 2 podziale na punkty sprzedazy 
%% MAG_PS := .T.
%% if (parametry) goto _parametry
// ===== wczytanie parametrow interface'u
%% RejOp["G:OtworzRej",naz_glob]
%% indexpar := "!INT_MAG_PS"
%% paramtxt := "T"
%% CallAlg["READ_PARAM"]
%% MAG_PS := paramlog
%% RejOp["G:ZamknijRej",""]
//%% goto _zacz
//
%% MAG_illinii := 0
%% paramkwt := 0
%% if (parametry) goto _parametry
// ===== wczytanie parametrow interface'u
//%% RejOp["G:OtworzRej","GLOBUSER.RJR"]
%% RejOp["G:OtworzRej",naz_glob]
// --- liczba linii
%% indexpar := "!INT_MAG_LINIA"
%% paramtxt := ""
%% CallAlg["READ_PARAM"]
%% MAG_illinii := paramkwt
// ---  WZ z faktura czy z dokumentem magazynowym 
%% indexpar := "!INT_MAG_KOSZTY"
%% paramtxt := "T"
%% CallAlg["READ_PARAM"]
%% MAG_koszt := paramlog
// ---  dekretacja zbiorcza czy poszczegolnymi dokumentami 
%% indexpar := "!INT_MAG_DEKRETY"
%% paramtxt := "T"
%% CallAlg["READ_PARAM"]
%% MAG_dekr := paramlog
// ---  ceny ew. zakupu czy brutto 
%% indexpar := "!INT_MAG_CENY"
%% paramtxt := "T"
%% CallAlg["READ_PARAM"]
%% MAG_cena := paramlog
// ---  DF fak. zakupu  
%% indexpar := "!INT_MAG_ZAK"
%% paramtxt := "T"
%% CallAlg["READ_PARAM"]
%% MAG_zak := paramlog
// ---  ksieg. wartosc dokum. lub linie z dokumentu -podzial na grupy
%% indexpar := "!INT_MAG_WAR"
%% paramtxt := "T"
%% CallAlg["READ_PARAM"]
%% MAG_war := paramlog
// ---  ksieg. wg stawek vat czy grup
%% indexpar := "!INT_MAG_RODZ"
%% paramtxt := "T"
%% CallAlg["READ_PARAM"]
%% MAG_rodz := paramlog
// ---  DF ksieg. wg stawek vat czy grup
%% indexpar := "!INT_MAG_RODZD"
%% paramtxt := "T"
%% CallAlg["READ_PARAM"]
%% MAG_rodzd := paramlog
// ---  ksieg. wg wydzialow
%% indexpar := "!INT_MAG_WYDZ"
%% paramtxt := "T"
%% CallAlg["READ_PARAM"]
%% MAG_wydz := paramlog
// ---  nr.dokum.,nr.wlas.dok.
%% indexpar := "!INT_MAG_NR"
%% paramtxt := "T"
%% CallAlg["READ_PARAM"]
%% MAG_nr := paramlog
%% RejOp["G:ZamknijRej",""]
//----------------------
%% _zacz:
//suma kwot netto,vat wyliczona z danych zdrodlowych dla paragonow
%% net_dok := 0
%% vat_dok := 0
//spsob naliczania vat od netto lub od brutto
%% vat_sposob := "N"
//suma netto, vat wyliczona pobrana wprost z danych zrodlowych
%% netto_vat := 0
%% vat_vat := 0
%% dat_ks := ''
%% m_ks := .
%% typ_d := ""
%% blk := ""
%% blkb := ""
%% rdz := ""
%% dotyczy := ""
%% kurs := 0
%% nr_kl_niem := ""
%% brt_dok :=0
%% net_dok := 0
%% vat_dok := 0
%% prt_dok := 0
%% net_tow := 0
%% brt_dew :=0
%% nip := ""
%% nip_wsp := ""
%% unia := .N.
%% kl_sym := ""
//rodzaj sprzedazy - H - hurt, S - detal
%% rdz_sprz := "S"
%% nr_fak := ""
%% ps := ""
%% pun := ""
%% nr_mag := ""
%% kw_brutto := 0
%% kod_kln1 := ""
%% nip_kln := 0
%% kod_kln2 := ""
%% stvat := ""
%% propr := ""
%% nazwak := ""
%% numer_fak_pfx := ""
%% str_numer_fak := ""
%% str_data_fak := ""
%% sumfak := 0
%% sumdok := 0
%% sumnet := 0
%% sumvat := 0
%% sumbrt := 0
%% sumdokb := 0
%% sumdokvs := 0
%% brt_dok :=0
%% dotyczy := ""
//%% sbrutto := 0
//%% snetto := 0
//%% sbrutto22 := 0
//%% snetto22 := 0
//%% svat22 := 0
%% kwbr := 0
%% kwtz := 0
%% kwtvz := 0
%% sfx := ""
%% grx := ""
%% ll := 0
%% RejOp["R:OtworzRej1","INT_DEKR.RXR"]
%% RejOp["R:ZnajdzRek",naz_int]
%% nr := 1
%% licz := 0
%% _numer:
%%  naz_txtp := RejWezP_S["R:DEKR_txt" + ToStr["#nr#S:0"]]
%%  if (naz_txtp = "") goto _loop
%% txtnr := "INT_TXT" + ToStr["#nr#S:0"] + ".RXR"
%% goto LLL
%% _loop:
%%  nr := nr + 1
%%  if (nr < 10) goto _numer
%% if (nr = 10) goto kom
%% LLL:
%% licz := licz + 1
//%% RejOp["R:ZamknijRej",""]
%% RejOp["Z:OtworzRej",txtnr]
%% RejOp["Z:WezPierwszyRek",""]
%% if (licz = 1 ) RejOp["UsunPlikRej",naz_baza]
%% RejOp["B:OtworzRej",naz_baza]
%% if (licz = 1) RejOp["UsunPlikRej",naz_firm]
%% RejOp["C:OtworzRej",naz_firm]
%% liczbarekordow := RejWezP_K["Z:LiczbaRekordow"]
%% RejOp["XX:OtworzRej","REJESTRKL.RXR"]
%% RejOp["XX:zmienkluczrej","6"]
%% RejOp["KNTR:OtworzRej",naz_kntr]
%% RejOp["KNTR:zmienkluczrej","1"]
%% wspolne:
%% if (liczbarekordow = 0) goto _end
%% lp := 0
%% pr := 0
%% sm := 60 - StrLen[ToStr["#liczbarekordow#S:0 > "]]
## DEFWINDOW = 11,10,11,70,ACHP,,,,,"Konwersja danych "
%% DispLine[ToStr["#liczbarekordow#S:0 > "]]
//madzia optibelt poczatek
//
%% rdzb := ""
%% blkb := ""
%% _next_imp_rek:
%% lp := lp + 1
%% rek := ToStr["#lp#S:0"]
%% propr :=FillString[6-strlen[rek],"0"]+rek 
//sprawdz czy linie poczatkowe - jesli pie liczba - to ok
%% mm := stringnaliczbe[strcut[RejWezP_S["Z:P00"],0,1]]
%% if (mm = . ) goto _disp_tlo
//jeden rekord = jedna faktura
//zapisz dane dotyczace kontrhenta
%% nip := ""
%% nip_wsp := ""
%% unia := .N.
%% kraj := RejWezP_S["Z:P08"]
%% waluta := RejWezP_S["Z:P16"]
%% nip := RejWezP_S["Z:P01"]
//sprawdz czy jest PL
%% if (strcut[nip,0,2]="PL") nip := strcut[nip,2,strlen[nip]-2]
//usun spacje jesli byla
%% if (strcut[nip,0,1]=" ") nip := strcut[nip,1,strlen[nip]-1]
%% if (not(kraj = "PL")) goto _export
%% kont_nip:
%% goto _firma
%% _kont_firma:
%% goto _write_fak
//
%% BEEP[0]
%% OkAlert["UWAGA - rekord "+rek+"$ $w polu nr 0 niedopuszczalne znaki"]
%% exit := .T.
%% goto _end
//
//
// --- wczytywanie danych o kontrahencie do rejestru INT_FIRM
%% _write_firm:
%% _firma:
//kod kontr = nr nip
//zamiennik - numer klienta niemiecki
%% nr_kl_niem := RejWezP_S["Z:P00"]
//%% kontr := RejWezP_S["Z:P01"]
%% kontr := nr_kl_niem
%% nip_kln1 := RejWezP_S["Z:P01"]
%% if (strcut[nip_kln1,0,2]="PL") nip_kln1 := strcut[nip_kln1,2,strlen[nip_kln1]-2]
%% if (strcut[nip_kln1,0,1]=" ") nip_kln1 := strcut[nip_kln1,1,strlen[nip_kln1]-1]
%% naz_kln1 := nr_kl_niem+" "+RejWezP_S["Z:P02"]
%% naz_kln2 := RejWezP_S["Z:P03"]
//szukaj w INT_KNTR (slownik zamiennikow kontrhnetow) wg NIP
%% if (RejOp["KNTR:ZnajdzRek",kontr]) goto _dd
//szukaj w rejestrkl wg NIP
%% kl_sym := ""
%% RejOp["XX:zmienkluczrej","6"]
%% if (not(RejOp["XX:ZnajdzRek",nip_kln1])) goto _dd1 
%% kont_kntr:
%% kl_sym := rejwezp_s["xx:kl_sym"]
//%% okalert["kl_sym = "+kl_sym]
//dodoaj do slownika zmainnikow
%% RejOp["KNTR:DodajRek",""]
//%% xRejWstawP_S["KNTR:SUFF_kod",nip_kln1]
%% xRejWstawP_S["KNTR:SUFF_kod",kontr]
%% xRejWstawP_S["KNTR:SUFF_sfx",kl_sym]
%% xRejWstawP_S["KNTR:SUFF_naz",naz_kln1]
%% xRejWstawP_S["KNTR:SUFF_adr",Rejwezp_s["z:p06"]+" "+RejWezP_S["Z:P07"]+" "+RejWezP_S["Z:P05"]]
%% xRejWstawP_S["KNTR:SUFF_nip",nip_kln1]
%% RejOp["KNTR:ZapiszRek",""]
%% _dd:
%% if (RejOp["C:ZnajdzRek",kontr]) goto _disp_tlo
%% RejOp["C:DodajRek",""]
%% xRejWstawP_S["C:FIRM_txtkln",kontr]
%% xRejWstawP_S["C:FIRM_txtfak",kontr]
%% xRejWstawP_S["C:FIRM_prordz",""]
%% xRejWstawP_S["C:FIRM_prokln",kl_sym]
%% xRejWstawP_S["C:FIRM_pronip",nip_kln1]
%% xRejWstawP_S["C:FIRM_proreg",""]
%% xRejWstawP_S["C:FIRM_propes",""]
%% xRejWstawP_S["C:FIRM_pronz1",naz_kln1]
%% xRejWstawP_S["C:FIRM_pronz2",naz_kln2]
%% xRejWstawP_S["C:FIRM_promst",Rejwezp_s["z:p06"]+" "+RejWezP_S["Z:P07"]]
%% xRejWstawP_S["C:FIRM_proadr",RejWezP_S["Z:P05"]]
%% xRejWstawP_S["C:FIRM_probnk",""]
%% xRejWstawP_S["C:FIRM_proknt",""]
%% xRejWstawP_S["C:FIRM_protl1",""]
%% xRejWstawP_S["C:FIRM_protl2",""]
%% xRejWstawP_S["C:FIRM_profax",""]
%% xRejWstawP_S["C:FIRM_protlx",""]
%% RejOp["C:ZapiszRek",""]
%% goto _kont_firma
//======================================================================
//wczytanie danych do dokumentu w PLN
%% write_pln:
%% okalert["dokument w PLN"]
%% goto _write_fak
%% goto _disp_tlo
//======================================================================
// --- wczytywanie danych o fakturze magazynowej do rejestru INT_BAZA
%% _write_fak:
//%% okalert["write_fak"]
//%% propr := ""
%% nr_fak := RejWezP_S["Z:P19"]
%% nr_kl_niem := RejWezP_S["Z:P00"]
%% dotyczy := RejWezP_S["Z:P09"]
%% kurs := 0
%% kw := 0
%% kw_str := ""
%% if (not(pustepole["Z:P37"])) kw_str := rejwezp_s["z:p37"]
%% CallAlg["liczba3"]
%% kurs := kw
%% brt_dok :=0
%% net_dok := 0
%% vat_dok := 0
%% prt_dok := 0
%% net_tow := 0
%% brt_dew :=0
//symbol dokumentu; FV, FVK
%% if (kraj = "PL") kod := "FV"
%% if (StrCut[nr_fak,0,3] = "113" or StrCut[nr_fak,0,3] = "114") kod := kod +"K"
//prefix operacji - na razie nie ma
//%% propr := kod+propr
%% if (kod == "MO" or kod == "RPV")okalert["Nieznany symbol dokumentu "+kod+"$przyjmuj|e ""DV"""]
//kod kontrahneta
%% klnsfx :=  kontr
//kwota brutto
%% kw := 0
%% kw_str := RejWezP_S["Z:P23"]
%% CallAlg["liczba3"]
%% brt_dok := kw
//%% okalert["kwota  brutto= "+kw]
%% if (waluta = "998") brt_dew := brt_dok
//dla EUR - oblicz kwote w pln
%% if (waluta = "998") brt_dok := round[brt_dok*kurs/100,2]
//%% okalert["brt_dok po przeliczeniu= "+brt_dok]
//porto
%% prt_dok := 0
%% if (pustepole["Z:p13"]) goto _kont_net
%% kw := 0
%% kw_str := RejWezP_S["Z:P13"]
%% CallAlg["liczba3"]
%% prt_dok := kw
%% _kont_net:
//netto 
%% kw := 0
%% kw_str := RejWezP_S["Z:P11"]
%% CallAlg["liczba3"]
%% net_dok := kw
%% net_tow := kw - prt_dok
//vat
%% kw := 0
%% kw_str := RejWezP_S["Z:P12"]
//%% okalert["kw_str = "+kw_str]
%% CallAlg["liczba3"]
%% vat_dok := kw
//%% okalert["vvvv = "+vat_dok]
//jesli korekta - zamien wszytskie kwoty (z wyjatkiem brutto ) na ujemne
%% if (StrCut[nr_fak,0,3] = "113" or StrCut[nr_fak,0,3] = "114") vat_dok := vat_dok*(-1)
%% if (StrCut[nr_fak,0,3] = "113" or StrCut[nr_fak,0,3] = "114") net_dok := net_dok*(-1)
%% if (StrCut[nr_fak,0,3] = "113" or StrCut[nr_fak,0,3] = "114") net_tow := net_tow*(-1)
%% term := RejWezP_S["Z:P35"]
//%% okalert["term = "+term]
%% termf := C_DATE[StringNaLiczbe[StrCut[term,2,2]],StringNaLiczbe[StrCut[term,4,2]],StringNaLiczbe[StrCut[term,6,2]]]
%% datff := RejWezP_S["Z:P21"]
%% datf := C_DATE[StringNaLiczbe[StrCut[datff,2,2]],StringNaLiczbe[StrCut[datff,4,2]],StringNaLiczbe[StrCut[datff,6,2]]]
%% str_data_fak := StrCut[datff,2,2]+"."+StrCut[datff,4,2]+"."+StrCut[datff,6,2]
//%% sdat := RejWezP_S["Z:P07"]
//%% sdatf := C_DATE[StringNaLiczbe[StrCut[sdat,0,2]],StringNaLiczbe[StrCut[sdat,3,2]],StringNaLiczbe[StrCut[sdat,6,2]]]
//%% sdatf := C_DATE[StringNaLiczbe[StrCut[sdat,2,2]],StringNaLiczbe[StrCut[sdat,5,2]],StringNaLiczbe[StrCut[sdat,8,2]]]
%% sdatf := datf
//2011.03.28 data dokumentu: najmlodsza data z wczytanych dokumentow - bierzez z P07, mozna zmienic
//%% if (sdatf > data_dok) data_dok := sdatf
%% dat := datf
%% if (dat > dat2) dat2 := dat
%% if (dat < dat1) dat1 := dat
//symbol faktury o transkacji
%% str_numer_fak := "S"+StrCut[datff,4,2]+"/"+nr_fak
%% typvatdok := kod
//zapisz rekord - dla samsung
%% if (nip = "7872082188") goto write_samsung
//zapisz rekord - dla EUR
%% if (waluta = "998") goto write_eur
//zapisz rekord - dla PLN
//WN_PLN strona WN brutto w pln
%% CallAlg["WRITE_NULL_TO_BAZA"]
//prefix
%% oprpfx := propr
%% oprkwt := brt_dok
%% oprkod := "WN_PLN"
%% oprnaz := "Brutto dokument w pln"
%% oprtrs := str_numer_fak+" "+str_data_fak+" "+naz_kln1
%% oprdat := sdatf
%% if (dat > dat2) dat2 := dat
%% if (dat < dat1) dat1 := dat
//%% dat1 := sdatf
//%% dat2 := sdatf
%% klnsfx := kontr
%% rdzsfx := kontr
%% rdznaz := naz_kln1
//rozrachunek
%% rzrfak := str_numer_fak
//
%% rzrdat := datf
%% rzrtrm := termf
%% rzrtyp := "O"
%% rzrrdz := "T"
%% CallAlg["WRITE_REKORD_TO_BAZA"]
%% kont_netto:
// netto sprzedaz towarow
//dekret MA_NETTO
//spraedaz towarow
%% CallAlg["WRITE_NULL_TO_BAZA"]
%% oprpfx := propr
%% oprkod := "NET_PLN"
%% rdzsfx := "700/2"
%% oprkwt := net_tow
%% oprnaz := "Netto pln"
%% oprtrs := str_numer_fak
%% oprdat := sdatf
%% CallAlg["WRITE_REKORD_TO_BAZA"]
// porto 
%% CallAlg["WRITE_NULL_TO_BAZA"]
%% oprpfx := propr
%% oprkod := "NET_PLN"
%% rdzsfx := "760/22"
%% oprkwt := prt_dok
%% oprnaz := "Netto pln"
%% oprtrs := str_numer_fak
%% oprdat := sdatf
%% CallAlg["WRITE_REKORD_TO_BAZA"]
// vat MA: VAT_PLN
%% stvat := RejWezP_S["Z:P14"]
%% CallAlg["WRITE_NULL_TO_BAZA"]
%% oprpfx := propr
%% oprkod := "VAT_PLN"
%% oprnaz := "Kwota vat z zapisu "
//%% okalert["vat_dok = "+vat_dok]
%% oprkwt := vat_dok
%% oprtrs := str_numer_fak
%% vatrej := "SPRZEDA|Z"
%% vatdok := str_numer_fak
%% vattyp := typvatdok
%% vatold := dotyczy
%% vatdat := datf
%% vatspr := datf
%% vatobw := datf
%% vatplt := termf
%% vattrojstra := .N.
%% if (unia) vatnipue := nip_wsp
%% if (unia) vatkodue := kraj
//kod kraju+info o transkacji trojstronnej (P08+p10)
%% vatsfx := RejWezP_S["Z:P08"]+"_" +RejWezP_S["Z:P10"]
%% vatgus := ""
%% klnsfx := kontr
%% vatnet := net_dok
%% vatbrt := brt_dok
%% CallAlg["WRITE_REKORD_TO_BAZA"]
%% goto _disp_tlo
//==========================================================
%% _disp_tlo:
%% CallAlg["DISPLAY_PASEK"]
%% _wez_next_imp_rek:
%% if (RejOp["Z:WezNastepnyRek",""]) goto _next_imp_rek
%% kon_wcz:
//
## DELWINDOW
%% CallAlg["ZAPISZ_DATY"]
//
%% totbrt := sumnet + sumvat
//%% okalert["DOKUMENTY"+sumdok+"$FAKTURY  "+sumfak+"$Suma NET "+sumnet+"$Suma VAT "+sumvat+"$Suma BRT "+sumbrt+"$Total BRT"+totbrt]
//%% if (Round[Round[sumnet,2] + Round[sumvat,2],2] = Round[sumbrt,2]) goto _end
//%% OkAlert["Niepoprawne dane !!!$ $netto "+sumnet+"$vat   "+sumvat+"$brutto"+sumbrt+"$razem "+total]
//%% if (not MAG_akcept) exit := .T.
//
%% _end:
%% nr := nr + 1
%% if (nr < 10) goto _numer
%% kom:
%% RejOp["R:ZamknijRej",""]
%% RejOp["Z:ZamknijRej",""]
%% RejOp["B:ZamknijRej",""]
%% RejOp["C:ZamknijRej",""]
%% RejOp["XX:ZamknijRej",""]
%% RejOp["KNTR:ZamknijRej",""]
%% break := .N.
%% ExitFrm[0]
//
//WN_SAM strona WN brutto w eur dla SAMSUNG
%% write_samsung:
%% CallAlg["WRITE_NULL_TO_BAZA"]
//prefix
%% oprpfx := propr
%% oprkwt := brt_dok
%% oprkod := "WN_SAM"
%% oprnaz := "Brutto Samsung "
%% oprtrs := str_numer_fak+" "+str_data_fak+" "+naz_kln1
%% oprdat := sdatf
%% if (dat > dat2) dat2 := dat
%% if (dat < dat1) dat1 := dat
//%% dat1 := sdatf
//%% dat2 := sdatf
%% klnsfx := kontr
//%% rdzsfx := "SAMSUNG1"
%% rdznaz := naz_kln1
//rozrachunek
%% rzrfak := str_numer_fak
%% rzrdat := datf
%% rzrtrm := termf
%% rzrtyp := "O"
%% rzrrdz := "T"
//dewizy
%% dewsfx := "EUR"
%% dewkwt := brt_dew
%% CallAlg["WRITE_REKORD_TO_BAZA"]
%% goto kont_netto
//
//WN_EUR strona WN brutto w eur 
%% write_eur:
%% CallAlg["WRITE_NULL_TO_BAZA"]
//prefix
%% oprpfx := propr
%% oprkwt := brt_dok
%% oprkod := "WN_EUR"
%% oprnaz := "Brutto EURO "
%% oprtrs := str_numer_fak+" "+str_data_fak+" "+naz_kln1
%% oprdat := sdatf
%% if (dat > dat2) dat2 := dat
%% if (dat < dat1) dat1 := dat
//%% dat1 := sdatf
//%% dat2 := sdatf
%% klnsfx := kontr
%% rdzsfx := kontr
%% rdznaz := naz_kln1
//rozrachunek
%% rzrfak := str_numer_fak
%% rzrdat := datf
%% rzrtrm := termf
%% rzrtyp := "O"
%% rzrrdz := "T"
//dewizy
%% dewsfx := "EUR"
%% dewkwt := brt_dew
%% CallAlg["WRITE_REKORD_TO_BAZA"]
%% goto kont_netto
//export - kraj inny niz polska
%% _export:
//sprawdz czy kraj z unii
%% nip_wsp := ""
%% if (kraj = "AT"  or kraj = "BE" or kraj = "BG" or kraj = "CY" or kraj = "DK" or kraj = "EE" or kraj = "FI" or kraj = "FR" or kraj = "GR" or kraj = "EL" or kraj = "ES" or kraj = "IE" or kraj = "LT" or kraj = "LU" or kraj = "LV" or kraj = "MT" or kraj = "NL" or kraj = "DE" or kraj = "PT" or kraj = "CZ" or kraj = "RO" or kraj = "SK" or kraj = "SI" or kraj = "SE" or kraj = "HU" or kraj = "GB" or kraj = "IT") unia := .T.
%% if (not(unia)) kod := "F"
%% if (not(unia)) goto kont_nip
%% nip_wsp := strcut[nip,2,strlen[nip]-2]
//sprawdz czy byla spacja
%% if (strcut[nip_wsp,0,1]=" ") nip_wsp := strcut[nip_wsp,1,strlen[nip_wsp]-1]
%% kod := "WD"
//%% okalert["nip_wsp = "+nip_wsp]
%% goto kont_nip
//szukaj w rej kontrahnetow po nipie wspolnootwym
%% _dd1:
%% if (nip_wsp = "" ) goto _dd
%% RejOp["XX:zmienkluczrej","5"]
%% if (not(RejOp["XX:ZnajdzRek",nip_wsp])) goto _dd 
%% goto kont_kntr
//
// ===== parametry polecenia
%% _parametry:
//%% RejOp["G:OtworzRej","GLOBUSER.RJR"]
%% RejOp["G:OtworzRej",naz_glob]
//czy w podziale na punkty sprzedazy
%% indexpar := "!INT_MAG_PS"
%% paramtxt := "T"
%% CallAlg["READ_PARAM"]
%% MAG_PS := paramlog
//
## DRAWDIALOG = GLOBAL
%% D_POS := 42
%% _wczytaj_dane:
## DODIALOG = GLOBAL
%% if (D_POS=92) goto _esc
## DELDIALOG = GLOBAL
//
%% indexpar := "!INT_MAG_PS"
%% paramtxt := "" + MAG_PS
%% CallAlg["WRITE_PARAM"]
//
%% _esc:
%% RejOp["G:ZamknijRej",""]
//
// ****** definicja dialogu 
## DEFDIALOG = GLOBAL
##DEFWINDOW =,,,,ADPSH,lwhite/black&white,lwhite/red&black/white,magenta/black&white,,"AGRICOLA: wczytywanie dokument|ow magazynowych "
## 20,0,D,,"TAK",,,,,,MAG_PS:log:1
## 21,0,D,,"NIE",,,,,,MAG_PS:log:2
##42,DTL,0,,"Wczytywa|c z podzia|lem na punkty sprzeda|zy ?",,&&lblue/white,&&lblue/lwhite  
## 91,,ADP,,@3
## 92,,ADP,,@4
                                          

   #42                                           #
   #20  #    
   #21  #                                           
 



   #91             #             #92             #
##
//---------------------------------
